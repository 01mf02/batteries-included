
.SUBDIRS: syntax
    export AAA_FILES
    .SUBDIRS: pa_comprehension pa_strings
	include OMakefile
	export AAA_FILES

EXTRA[] =
    batteries_help.cmo

OBJECTS[] =
    legacy
    base64
    batArg
    batArray
    batBigarray
    batBig_int
    batBool
    batBuffer
    batChar
    batComplex
    batDigest
    batEnum
    batFloat
    batFormat
    batGc
    batGenlex
    batHashtbl
    batIO
    batInnerIO
    batInt32
    batInt64
    batInt
    batLexing
    batList
    batMap
    batMarshal
    batMutex
    batNativeint
    batNum
    batOo
    batPervasives
    batPrintexc
    batPrintf
    batQueue
    batRandom
    batScanf
    batSet
    batStack
    batStream
    batString
    batStr
    batSys
    batUChar
    batUnit
    batUnix
    batUTF8
    bitSet
    charEncodings
    charParser
    concurrent
    dllist
    dynArray
    file
    global
    innerWeaktbl
    interfaces
    IOThreads
    lazyList
    logger
    monad
    multiPMap
    number
    option
    optParse
    pair
    parserCo
    pathGen
    pMap
    print
    pSet
    refList
    ref
    result
    return
    rMutex
    rope
    seq
    std
    substring
    uCharParser
    value_printer
    vect
    avlTree
    iSet
    iMap
    batteries_config
    batteries_print
    batteries

OCamlLibrary(batteries, $(OBJECTS))

batteries_config.ml: batteries_config.mlp
	rm(-f batteries_config.ml)
	sed -e 's|@VERSION@|$(VERSION)|' \
            -e 's|@DOCROOT@|$(DOCROOT)|' \
            -e 's|@BROWSER_COMMAND@|$(BROWSER_COMMAND)|' \
	    batteries_config.mlp > batteries_config.ml
	chmod(444 batteries_config.ml)

AAA_FILES[] += $(file $(glob *.mli *.cmi *.cma *.cmxa *.a $(EXTRA)))

all: batteries.cmxa batteries.cma $(EXTRA)
