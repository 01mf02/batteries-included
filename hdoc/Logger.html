<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="LazyList.html">
<link rel="next" href="Monad.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="AvlTree" rel="Chapter" href="AvlTree.html">
<link title="Base64" rel="Chapter" href="Base64.html">
<link title="BatArg" rel="Chapter" href="BatArg.html">
<link title="BatArray" rel="Chapter" href="BatArray.html">
<link title="BatBig_int" rel="Chapter" href="BatBig_int.html">
<link title="BatBigarray" rel="Chapter" href="BatBigarray.html">
<link title="BatBool" rel="Chapter" href="BatBool.html">
<link title="BatBuffer" rel="Chapter" href="BatBuffer.html">
<link title="BatChar" rel="Chapter" href="BatChar.html">
<link title="BatComplex" rel="Chapter" href="BatComplex.html">
<link title="BatDigest" rel="Chapter" href="BatDigest.html">
<link title="BatFloat" rel="Chapter" href="BatFloat.html">
<link title="BatFormat" rel="Chapter" href="BatFormat.html">
<link title="BatGc" rel="Chapter" href="BatGc.html">
<link title="BatGenlex" rel="Chapter" href="BatGenlex.html">
<link title="BatHashtbl" rel="Chapter" href="BatHashtbl.html">
<link title="BatInt" rel="Chapter" href="BatInt.html">
<link title="BatInt32" rel="Chapter" href="BatInt32.html">
<link title="BatInt64" rel="Chapter" href="BatInt64.html">
<link title="BatLexing" rel="Chapter" href="BatLexing.html">
<link title="BatList" rel="Chapter" href="BatList.html">
<link title="BatMap" rel="Chapter" href="BatMap.html">
<link title="BatMarshal" rel="Chapter" href="BatMarshal.html">
<link title="BatMutex" rel="Chapter" href="BatMutex.html">
<link title="BatNativeint" rel="Chapter" href="BatNativeint.html">
<link title="BatNum" rel="Chapter" href="BatNum.html">
<link title="BatOo" rel="Chapter" href="BatOo.html">
<link title="BatPervasives" rel="Chapter" href="BatPervasives.html">
<link title="BatPrintexc" rel="Chapter" href="BatPrintexc.html">
<link title="BatPrintf" rel="Chapter" href="BatPrintf.html">
<link title="BatQueue" rel="Chapter" href="BatQueue.html">
<link title="BatRandom" rel="Chapter" href="BatRandom.html">
<link title="BatScanf" rel="Chapter" href="BatScanf.html">
<link title="BatSet" rel="Chapter" href="BatSet.html">
<link title="BatStack" rel="Chapter" href="BatStack.html">
<link title="BatStr" rel="Chapter" href="BatStr.html">
<link title="BatStream" rel="Chapter" href="BatStream.html">
<link title="BatString" rel="Chapter" href="BatString.html">
<link title="BatSys" rel="Chapter" href="BatSys.html">
<link title="BatUChar" rel="Chapter" href="BatUChar.html">
<link title="BatUTF8" rel="Chapter" href="BatUTF8.html">
<link title="BatUnit" rel="Chapter" href="BatUnit.html">
<link title="BatUnix" rel="Chapter" href="BatUnix.html">
<link title="BitSet" rel="Chapter" href="BitSet.html">
<link title="CharEncodings" rel="Chapter" href="CharEncodings.html">
<link title="CharParser" rel="Chapter" href="CharParser.html">
<link title="Concurrent" rel="Chapter" href="Concurrent.html">
<link title="Dllist" rel="Chapter" href="Dllist.html">
<link title="DynArray" rel="Chapter" href="DynArray.html">
<link title="Enum" rel="Chapter" href="Enum.html">
<link title="File" rel="Chapter" href="File.html">
<link title="Global" rel="Chapter" href="Global.html">
<link title="IMap" rel="Chapter" href="IMap.html">
<link title="IO" rel="Chapter" href="IO.html">
<link title="ISet" rel="Chapter" href="ISet.html">
<link title="InnerIO" rel="Chapter" href="InnerIO.html">
<link title="InnerWeaktbl" rel="Chapter" href="InnerWeaktbl.html">
<link title="Interfaces" rel="Chapter" href="Interfaces.html">
<link title="LazyList" rel="Chapter" href="LazyList.html">
<link title="Logger" rel="Chapter" href="Logger.html">
<link title="Monad" rel="Chapter" href="Monad.html">
<link title="MultiPMap" rel="Chapter" href="MultiPMap.html">
<link title="Number" rel="Chapter" href="Number.html">
<link title="OptParse" rel="Chapter" href="OptParse.html">
<link title="Option" rel="Chapter" href="Option.html">
<link title="PMap" rel="Chapter" href="PMap.html">
<link title="PSet" rel="Chapter" href="PSet.html">
<link title="ParserCo" rel="Chapter" href="ParserCo.html">
<link title="PathGen" rel="Chapter" href="PathGen.html">
<link title="Print" rel="Chapter" href="Print.html">
<link title="RMutex" rel="Chapter" href="RMutex.html">
<link title="Ref" rel="Chapter" href="Ref.html">
<link title="RefList" rel="Chapter" href="RefList.html">
<link title="Result" rel="Chapter" href="Result.html">
<link title="Return" rel="Chapter" href="Return.html">
<link title="Rope" rel="Chapter" href="Rope.html">
<link title="Seq" rel="Chapter" href="Seq.html">
<link title="Std" rel="Chapter" href="Std.html">
<link title="Substring" rel="Chapter" href="Substring.html">
<link title="UCharParser" rel="Chapter" href="UCharParser.html">
<link title="Value_printer" rel="Chapter" href="Value_printer.html">
<link title="Vect" rel="Chapter" href="Vect.html"><link title="log modules" rel="Section" href="#6_logmodules">
<link title="log events" rel="Section" href="#6_logevents">
<link title="log formatters" rel="Section" href="#6_logformatters">
<link title="logger initialization" rel="Section" href="#6_loggerinitialization">
<link title="log utilities" rel="Section" href="#6_logutilities">
<title>Logger</title>
</head>
<body>
<div class="navbar"><a href="LazyList.html">Previous</a>
&nbsp;<a href="index.html">Up</a>
&nbsp;<a href="Monad.html">Next</a>
</div>
<center><h1>Module <a href="type_Logger.html">Logger</a></h1></center>
<br>
<pre><span class="keyword">module</span> Logger: <code class="code">sig</code> <a href="Logger.html">..</a> <code class="code">end</code></pre><a name="1_LoggingLibrary"></a>
<h1>Logging Library</h1>
<p>

This module defines functions which implement a flexible error logging
system for applications.<br>
<b>Author(s):</b> Warren Harris, Metaweb Technologies<br>
<hr width="100%">
<br>
<a name="6_logmodules"></a>
<h6>log modules</h6><br>
<pre><span class="keyword">type</span> <a name="TYPElog"></a><code class="type"></code>log </pre>

<br><code><span class="keyword">type</span> <a name="TYPElevel"></a><code class="type"></code>level = </code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">NONE</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">FATAL</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">ERROR</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">WARN</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">NOTICE</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">INFO</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">DEBUG</span></code></td>

</tr></table>


<pre><span class="keyword">val</span> <a name="VALmake_log"></a>make_log : <code class="type">string -> <a href="Logger.html#TYPElog">log</a></code></pre><div class="info">
<code class="code">make_log name</code> returns a new logger.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALlog_name"></a>log_name : <code class="type"><a href="Logger.html#TYPElog">log</a> -> string</code></pre><div class="info">
<code class="code">log_name logger</code> returns the name of the logger.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALlog_enable"></a>log_enable : <code class="type"><a href="Logger.html#TYPElog">log</a> -> <a href="Logger.html#TYPElevel">level</a> -> unit</code></pre><div class="info">
<code class="code">log_enable logger level</code> enables a log level for a logger.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALlog_level"></a>log_level : <code class="type"><a href="Logger.html#TYPElog">log</a> -> <a href="Logger.html#TYPElevel">level</a></code></pre><div class="info">
<code class="code">log_level logger</code> returns the currently enabled level for a logger.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALlog_enabled"></a>log_enabled : <code class="type"><a href="Logger.html#TYPElog">log</a> -> <a href="Logger.html#TYPElevel">level</a> -> bool</code></pre><div class="info">
<code class="code">log_enabled logger level</code> returns true if the specified level is
       currently enabled for the logger.<br>
</div>
<br>
<a name="6_logevents"></a>
<h6>log events</h6><br>
<pre><span class="keyword">type</span> <a name="TYPEevent"></a><code class="type"></code>event = <code class="type">string * (string * string) list</code> </pre>
<div class="info">
A log <code class="code">event</code> consists of an event name and a list of key-value
       parameters (an association list). Events are constructed by
       <code class="code">log</code> when a log level is enabled and passed to log formatters
       to render them to any logging output stream.<br>
</div>

<pre><span class="keyword">val</span> <a name="VALlog"></a>log : <code class="type"><a href="Logger.html#TYPElog">log</a> -> <a href="Logger.html#TYPElevel">level</a> -> (unit -> <a href="Logger.html#TYPEevent">event</a>) -> unit</code></pre><div class="info">
<code class="code">log logger level event_fun</code> raises a log event if if the
       specified level is currently enabled for the logger. The
       function <code class="code">event_fun ()</code> is called to return the event record,
       and is a function in order to delay construction or formatting
       of any event parameters in the case where the specified log
       level is not enabled. For example:
<p>

       <pre><code class="code">log io_log INFO (fun () -&gt; "connect", ["ADDR", addr])</code></pre>
<p>

       would only log the <code class="code">"connect"</code> event (with the <code class="code">"ADDR"</code> string
       parameter) when the <code class="code">INFO</code> log level was enabled for the
       <code class="code">io_log</code> logger.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALwith_log"></a>with_log : <code class="type"><a href="Logger.html#TYPElog">log</a> -><br>       <a href="Logger.html#TYPElevel">level</a> -><br>       (unit -> <a href="Logger.html#TYPEevent">event</a>) -> ?result:('a -> string) -> (unit -> 'a) -> 'a</code></pre><div class="info">
<code class="code">with_log logger level event_fun ?result body</code> logs an event
       before and after calling <code class="code">body ()</code>. The function <code class="code">event_fun ()</code>
       is called to return the event record to be logged. After the
       body is evaluated, the <code class="code">result</code> function is used to convert the
       body's result value into a string, which is added to the event
       record as a <code class="code">"RESULT"</code> parameter (if no <code class="code">result</code> function is
       supplied then a <code class="code">"-"</code> is used). In the case where the body
       raises an exception, an <code class="code">"EXN"</code> parameter is instead added to
       the event containing the name of the exception. In addition, an
       indentation level is maintained throughout the duration of the
       body such that any other log statements occurring inside the
       body will see an incremented indentation level. This is added
       to the event key-value arguments as an additional <code class="code">"I"</code>
       parameter.<br>
</div>
<br>
<a name="6_logformatters"></a>
<h6>log formatters</h6><br>
<pre><span class="keyword">type</span> <a name="TYPEformatter"></a><code class="type"></code>formatter = <code class="type"><a href="Logger.html#TYPElog">log</a> -> <a href="Logger.html#TYPElevel">level</a> -> <a href="Logger.html#TYPEevent">event</a> -> float -> unit</code> </pre>
<div class="info">
the type of a log formatter is a function that takes the
       logger, the level of the log statement (which will be the
       currently enabled level or one of its successors), the event
       record, and a unix timestamp indicating the time the event was
       created.<br>
</div>

<pre><span class="keyword">val</span> <a name="VALregister_formatter"></a>register_formatter : <code class="type">string -> <a href="Logger.html#TYPEformatter">formatter</a> -> unit</code></pre><div class="info">
<code class="code">register_formatter name formatter</code> registers a named log
       formatter. The name is only used for subsequent calls to
       identify the formatter via <code class="code">unregister_formatter</code>.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALunregister_formatter"></a>unregister_formatter : <code class="type">string -> unit</code></pre><div class="info">
<code class="code">unregister_formatter name</code> unregisters a named log formatter.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALmake_std_formatter"></a>make_std_formatter : <code class="type">Pervasives.out_channel -> <a href="Logger.html#TYPEformatter">formatter</a></code></pre><div class="info">
<code class="code">make_std_formatter oc</code> constructs a formatter from an output
       channel.  This formatter will format log events as
       tab-separated <code class="code">&lt;keyword&gt;:&lt;value&gt;</code> pairs. The resulting
       formatter must be registered via <code class="code">register_formatter</code> to be
       used when events are raised. This formatter also always outputs
       special parameters that describe the event timestamp (an
       ISO-8610 timestamp prefixed by <code class="code">"D"</code>), the event name (the log
       module name followed by a dot, followed by the event name,
       prefixed by <code class="code">"E"</code>), the log level (prefixed by <code class="code">"L"</code>), the
       indentation level ( prefixed by <code class="code">"I"</code>), followed by any other
       event parameters. For example, the log statement:
<p>

       <pre><code class="code">log io_log INFO (fun () -&gt; "connect", ["ADDR", addr])</code></pre>
<p>

       would produce formatted output like the following when the
       <code class="code">io_log</code> <code class="code">INFO</code> level was enabled:
<p>

       <pre><code class="code">D:2009-01-26T00:47:45.033329Z   E:io.connect   L:INFO   I:1   ADDR:localhost:8080</code></pre><br>
</div>
<pre><span class="keyword">val</span> <a name="VALstderr_formatter"></a>stderr_formatter : <code class="type"><a href="Logger.html#TYPEformatter">formatter</a></code></pre><div class="info">
<code class="code">stderr_formatter</code> is a standard formatter that outputs log
       events to stderr using the same format as
       <code class="code">make_std_formatter</code>. The resulting formatter must be
       registered via <code class="code">register_formatter</code> or supplied to <code class="code">init</code> or
       <code class="code">init_from_string</code> to be used when events are raised.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALnull_formatter"></a>null_formatter : <code class="type"><a href="Logger.html#TYPEformatter">formatter</a></code></pre><div class="info">
<code class="code">null_formatter</code> is a formatter that does not output any
       events, but simply discards them.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALmake_dbg_formatter"></a>make_dbg_formatter : <code class="type">Pervasives.out_channel -> <a href="Logger.html#TYPEformatter">formatter</a></code></pre><div class="info">
<code class="code">make_dbg_formatter oc</code> constructs a debug formatter from an
       output channel. The debug formatter outputs simplified format
       that is easier to read for debugging purposes and displays
       indentation level. E.g.:
<p>

       <pre><code class="code">       with_log io_log DEBUG (fun () -&gt; "listener" ["ADDR", addr])
         accept_connections (* calls other log statements *)
       </code></pre>
<p>

       would produce formatted output like the following when the <code class="code">io_log</code>
       <code class="code">DEBUG</code> level was enabled:
<p>

       <pre><code class="code">       ### io.listener ADDR:localhost:8080 [DEBUG]
       ### | io.connected CLIENT_ADDR:192.168.0.23:28303 [DEBUG]
       ### | io.disconnected CLIENT_ADDR:192.168.0.23:28303 [DEBUG]
       ...
       ### io.listener ADDR:localhost:8080 RESULT:- [DEBUG]
       </code></pre><br>
</div>
<pre><span class="keyword">val</span> <a name="VALdbg_formatter"></a>dbg_formatter : <code class="type"><a href="Logger.html#TYPEformatter">formatter</a></code></pre><div class="info">
<code class="code">dbg_formatter</code> is a debug formatter that outputs log events to
       stderr using the same format as <code class="code">make_dbg_formatter</code>. The
       resulting formatter must be registered via <code class="code">register_formatter</code>
       or supplied to <code class="code">init</code> or <code class="code">init_from_string</code> to be used when
       events are raised.<br>
</div>
<br>
<a name="6_loggerinitialization"></a>
<h6>logger initialization</h6><br>
<pre><span class="keyword">val</span> <a name="VALinit"></a>init : <code class="type">(string * <a href="Logger.html#TYPElevel">level</a>) list -> <a href="Logger.html#TYPEformatter">formatter</a> -> unit</code></pre><div class="info">
<code class="code">init name_level_list formatter</code> initializes the logging
        system enabling the specified levels for each named
        logger. The formatter is the initial formatter for any log
        events that are output and is registered with the name
        "default" (other formatters may be registered by
        <code class="code">register_formatter</code>).<br>
</div>
<pre><span class="keyword">val</span> <a name="VALinit_from_string"></a>init_from_string : <code class="type">string -> <a href="Logger.html#TYPEformatter">formatter</a> -> unit</code></pre><div class="info">
<code class="code">init_from_string name_level_string formatter</code> initializes the
       logging system enabling the specified levels for each named
       logger. The string must be a comma separated list of <code class="code">&lt;logger
       name&gt;:&lt;level name&gt;</code> pairs, e.g.  <code class="code">"FOO:ERROR,BAR:WARN"</code>. If a
       un-prefixed level name is specified, then that becomes the
       default log level for all newly created logs, and all currently
       created logs are enabled to that level. If the logger does not
       yet exist, it is created. The formatter is the initial
       formatter for any log events that are output and is registered
       with the name "default" (other formatters may be registered by
       <code class="code">register_formatter</code>).<br>
</div>
<br>
<a name="6_logutilities"></a>
<h6>log utilities</h6><br>
<pre><span class="keyword">val</span> <a name="VALlevel_of_name"></a>level_of_name : <code class="type">string -> <a href="Logger.html#TYPElevel">level</a></code></pre><div class="info">
<code class="code">level_of_name str</code> returns the <code class="code">level</code> associated with <code class="code">str</code>.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALname_of_level"></a>name_of_level : <code class="type"><a href="Logger.html#TYPElevel">level</a> -> string</code></pre><div class="info">
<code class="code">name_of_level level</code> returns the name of the specified <code class="code">level</code>.<br>
</div>
<pre><span class="keyword">val</span> <a name="VALformat_timestamp"></a>format_timestamp : <code class="type">Pervasives.out_channel -> float -> unit</code></pre><div class="info">
<code class="code">format_timestamp oc timestamp</code> prints an ISO-8601 formatted
       timestamp (extended to specify higher-resolution seconds) to
       the output channel, <code class="code">oc</code>.<br>
</div>
</body></html>